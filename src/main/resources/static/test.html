<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<h1>User testing</h1>

<label>First name:</label>
<input id="name" name="fname" type="text"><br><br>
<label>Email:</label>
<input id="email" name="lname" type="text"><br><br>
<label>Type:</label>
<input id="type" name="lname" type="text"><br><br>
<button id="submit">Save</button>
<br><br>

<label>Id:</label>
<input id="userId" type="text"><br><br>
<button id="delete">Delete</button>


<br><br>
<button id="employees">Employee List</button>
<table id="table">
    <tr>
        <th>Id</th>
        <th>Name</th>
        <th>Email</th>
        <th>Type</th>
    </tr>
</table>

<script>
    console.log("working");
    document.getElementById("submit").addEventListener('click', function (ev) {

        let name = document.getElementById("name").value;
        let email = document.getElementById("email").value;
        let type = document.getElementById("type").value;

        fetch("http://localhost:8080/users", {
            method: 'POST',
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                name: name,
                email: email,
                type: type
            })
        }).then(
            console.log("Success")
        );


        ev.preventDefault();
    });

    document.getElementById("delete").addEventListener('click', function (ev) {

        let userId = document.getElementById("userId").value;

        fetch("http://localhost:8080/users/" + userId, {
            method: 'DELETE'
        }).then(
            console.log("Success")
        );

        ev.preventDefault();
    });

    document.getElementById("employees").addEventListener('click', function (ev) {

        let table = document.getElementById("table");

        // let testData = [
        //     {
        //         id: 1,
        //         name: 'Ivan Todorov',
        //         email: 'ivan@abv.bg',
        //         type: 'Employee'
        //     },
        //     {
        //         id: 2,
        //         name: 'Ivka Todorova',
        //         email: 'ivan@abv.bg',
        //         type: 'Employee'
        //     }
        // ]

        // testData.forEach(element => {
        //     let tr = document.createElement("tr");

        //     let thId = document.createElement("th");
        //     thId.appendChild(document.createTextNode(element.id));
        //     tr.appendChild(thId);

        //     let thName = document.createElement("th");
        //     thName.appendChild(document.createTextNode(element.name));
        //     tr.appendChild(thName);

        //     let thEmail = document.createElement("th");
        //     thEmail.appendChild(document.createTextNode(element.email));
        //     tr.appendChild(thEmail);

        //     let thType = document.createElement("th");
        //     thType.appendChild(document.createTextNode(element.type));
        //     tr.appendChild(thType);

        //     table.appendChild(tr);
        // });


        fetch("http://localhost:8080/users/employees", {
            method: 'GET'
        })
            .then(response => response.json())
            .then(data => {
                data.forEach(element => {
                    let tr = document.createElement("tr");

                    let thId = document.createElement("th");
                    thId.appendChild(document.createTextNode(element.id));
                    tr.appendChild(thId);

                    let thName = document.createElement("th");
                    thName.appendChild(document.createTextNode(element.name));
                    tr.appendChild(thName);

                    let thEmail = document.createElement("th");
                    thEmail.appendChild(document.createTextNode(element.email));
                    tr.appendChild(thEmail);

                    let thType = document.createElement("th");
                    thType.appendChild(document.createTextNode(element.userType));
                    tr.appendChild(thType);

                    table.appendChild(tr);
                });


            });


        ev.preventDefault();
    });


</script>


</body>
</html>